2. Ustvarite podatkovno zbirko mongo_test in v kolekcijo osebe vnesite svoj ime in priimek.

use mongo_test

db.osebe.insert({"ime":"Nejc", "priimek":"Mihelic"})



3. Izpišite vse podatke iz kolekcije osebe.

db.osebe.find()



4. Ustvarite omejeno kolekcijo stranke (1kB in 3 zapise).

db.createCollection("stranke", {capped:1, size:1024, max:3})



5. Vnesite v kolekcijo stranke pet dokumentov, ki naj vsebujejo ime, priimek, poštno številko in dve telefonski številki.

db.stranke.insert({"ime":"Janez", "priimek":"Novak", "posta":4000, "telefon":[040123456, 049876543]})

db.stranke.insert({"ime":"Petra", "priimek":"Kalan", "posta":2000, "telefon":[040123456, 049876543]})

db.stranke.insert({"ime":"Simon", "priimek":"Gregoric", "posta":4000, "telefon":[040123456, 049876543]})

db.stranke.insert({"ime":"Žiga", "priimek":"Jereb", "posta":1000, "telefon":[040123456, 049876543]})

db.stranke.insert({"ime":"Janja", "priimek":"Novak", "posta":2000, "telefon":[040123456, 049876543]})



6. Izpišite vse dokumente iz kolekcije stranke.

db.stranke.find()



7. Iz MySQL-a izvozite tabelo drzave kot csv datoteko loceno s vejico.

Uvozite to v mongoDB v kolekcijo drzave.

C:\xampp\mysql\bin>mysql -u root < drzave.sql



C:\xampp\mysql\bin>mysqldump -u root drzave drzave --tab=. --fields-terminated-by="," --default-character-set="utf8"



C:\xampp\mysql\bin>cd C:\



C:\>cd Mongo



C:\Mongo>cd MongoDB



C:\Mongo\MongoDB>mongoimport /d mongo_test /c drzave /type:csv /fields:_id,drzava,regija,povrsina,prebivalstvo,bdp /file:drzave.txt





8. Ugotovite, katere kolekcije so v podatkovni zbirki mongo test.

show collections



9. Izvozite kolekcijo stranke iz podatkovne zbirko mongo_test v datoteko stranke.json.

C:\Mongo\MongoDB>mongoexport /d mongo_test /c stranke /out:stranke.json




1. Izpišite vse podatke iz tabele države.

db.drzave.find()


2. Izpišite vse podatke za Slovenijo.

db.drzave.find({"drzava":"Slovenija"})


3. Izpišite vse podatke za Slovenijo in Avstrijo.

db.drzave.find({ 

    $or: [{"drzava":"Slovenija"}, {"drzava":"Avstrija"}] 

})


4. Izpišite vse podatke za Slovenijo, Nizozemsko, Belgijo, Norveško in Španijo.

db.drzave.find({ 

    drzava: {$in: ["Slovenija", "Nizozemska", "Belgija", "Norveška", "Španija"]  }

})


5. Izpišite imena vseh držav, ki so velike med 10.000 in 30.000 km2. Spisek uredite po abecednem vrstnem redu narašcajoce.

db.drzave.find({   $and: [{"povrsina":{$gte:10000}}, {"povrsina":{$lte:30000}} ]   }, {"_id":0, "drzava":1, "povrsina":1}).sort({"drzava":1})


6. Izpišite imena vseh evropskih držav v bazi. Spisek uredite po abecednem vrstnem redu padajoce.

db.drzave.aggregate([

    { $group: {_id:"$regija", drzave: {$push:"$drzava"} } },

    { $match: {"_id":"Evropa" } },

    { $sort: {"drzava":-1} }

])


7. Izpišite vse podatke o drzavah, katerih ime se pricne s crko H.

db.drzave.find({

    "drzava":/^H/

})

    
8. Izpišite vse podatke o drzavah, ki imajo v regiji besedo Amerika (Južna Amerika, Severne Amerika, Srednja Amerika).
db.drzave.find({

    "regija":/Amerika/

})

9. Prikažite ime države ter število prebivalcev na km2 površine države. Spisek uredite enkrat padajoce in enkrat narašcajoce 
po gostoti prebivalstva. Stolpec, ki prikazuje število prebivalcev na km2, poimenujte »Gostota prebivalstva«.
db.drzave.aggregate([
    { $project: { "_id":0, "drzava":1, "Gostota prebivalstva": { $divide: ["$prebivalstvo", "$povrsina"] } } },
    { $sort: {"Gostota prebivalstva" : -1} }
])

    

10. Prikažite gostoto prebivalstva za Slovenijo. V glavi stolpca naj piše: »Gostota prebivalstva za Slovenijo«.

db.drzave.aggregate([

    { $project: { "_id":0, "drzava":1, "Gostota prebivalstva za Slovenijo": { $divide: ["$prebivalstvo", "$povrsina"] } } },

    { $match: {"drzava":"Slovenija"} }

])

    

11. Prikažite ime države in BDP na prebivalca. Spisek naj bo urejen narašcajoce po BDP-ju na prebivalca. Stolpec, v katerem je prikazana 

izracunana vrednost, naj se imenuje: »BDP na prebivalca«.

db.drzave.aggregate([

    { $project: { "_id":0, "drzava":1, "BDP na prebivalca": { $divide: ["$BDP", "$prebivalstvo"] } } },

    { $sort: {"BDP na prebivalca" : -1} }

])

    

12. Stolpcu dajte ime »Število evropskih držav v bazi« in izpišite podatke o številu držav, pri katerih je kot regija navedena Evropa.

db.drzave.aggregate([

    { $group: {_id:"$regija", "Stevilo Evropskih drzav": {$sum:1} } },

    { $match: {"_id":"Evropa" } }

])



13. Koliko je držav z vec kot 50 milijoni prebivalcev?

db.drzave.aggregate([

    { $match: { "prebivalstvo":{$gt:50000000} } },

    { $group: {_id:null, "Stevilo drzav z vec kot 50 milijonov prebivalcev": {$sum:1} } }

])



14. Koliko je skupno število prebivalcev v drzavah, ki so v bazi?

db.drzave.aggregate([

    { $group: {_id:null, "Stevilo prebivalcev": {$sum:"$prebivalstvo"} } }

])



15. Koliko je skupno število prebivalcev v evropski regiji?

db.drzave.aggregate([

    { $group: {_id:"$regija", "Stevilo prebivalcev": {$sum:"$prebivalstvo"} } },

    { $match: {_id:"Evropa"} }

])



16. Prikažite skupno število prebivalcev za posamezno regijo. Seznam naj bo urejen padajoce po skupnem številu prebivalcev.

db.drzave.aggregate([

    { $group: {_id:"$regija", "Stevilo prebivalcev": {$sum:"$prebivalstvo"} } },

    { $sort: {"Stevilo prebivalcev":-1} }

])



17. Prikažite vse regije, ki imajo vec kot 500.000.000 prebivalcev.

db.drzave.aggregate([

    { $group: {_id:"$regija", "Stevilo prebivalcev": {$sum:"$prebivalstvo"} } },

    { $match: {"Stevilo prebivalcev":{$gt:500000000} } }

])



1.
Na testu bo ena od teh variant.
- mongoimport /d tretji_test /c knjige1 /type:csv /fields:ID,priimek,ime,naslov,strani,cena,leto < knjige1.csv
- mongoimport /d tretji_test /c knjige2 /jsonArray < knjige2.json
- mongoimport /d tretji_test /c knjige3 /type:tsv /fields:ID,priimek,ime,naslov,strani,cena,leto < knjige3.tsv
- mongoimport /d tretji_test /c knjige4 /type:csv /headerline < knjige4.csv
- mongoimport /d tretji_test /c knjige5 < knjige5.json
- mongoimport /d tretji_test /c knjige6 /type:tsv /headerline < knjige6.tsv


a) Zanimajo nas vsi podatki vseh knjig v bazi, ki so bile izdane v letih od 1995 do 2005 (vključno).
db.knjige2.find({ $and: [ {"Leto":{$gte:1995}}, {"Leto":{$lte:2005} } ] })

b) Izpišimo vse naslove knjig in cene, pri tem nas zanimajo samo knjige dražje od 29 EUR. Izpis uredimo po ceni padajoče.
db.knjige2.find({ "Cena":{$gt:29} }, {"_id":0, "Naslov":1, "Cena":1} ).sort({"Cena":-1})

c) Zanimajo nas priimki vseh avtorjev, ki se pričnejo s črko M.
db.knjige2.find({ "Priimek_avtorja":/^M/ }, {"_id":0, "Priimek_avtorja":1})

d) Zanima nas, koliko knjig je bilo izdanih po posameznih letih. Spisek naj bo urejen po letih naraščajoče.
db.knjige2.aggregate([
    { $group: {_id:"$Leto", "Stevilo knjig v letu": {$sum:1} } },
    { $sort: {_id:1} }
])

e) Koliko znaša povprečna cena knjige izdane v letu 2001?
db.knjige2.aggregate([
    { $match: { "Leto":2001 } },
    { $group: { _id:"$Leto", "Povprecna cena knjige":{$avg:"$Cena"} } }
])

f) Izpiši število strani in naslov knjige za tri knjige, ki imajo največ strani.
db.knjige2.find({}, {"_id":0, "Naslov":1, "Strani":1}).sort({ "Strani":-1 }).limit(3)



2.
a) Vstavite deset dokumentov z vašim imenom, priimkom in zaporedno številko od 100 naprej.
db.dijaki.insert({"Ime":"Nejc", "Priimek":"Mihelič", "Stevilka":101})
db.dijaki.insert({"Ime":"Nejc", "Priimek":"Mihelič", "Stevilka":102})
db.dijaki.insert({"Ime":"Nejc", "Priimek":"Mihelič", "Stevilka":103})
db.dijaki.insert({"Ime":"Nejc", "Priimek":"Mihelič", "Stevilka":104})
db.dijaki.insert({"Ime":"Nejc", "Priimek":"Mihelič", "Stevilka":105})
db.dijaki.insert({"Ime":"Nejc", "Priimek":"Mihelič", "Stevilka":106})
db.dijaki.insert({"Ime":"Nejc", "Priimek":"Mihelič", "Stevilka":107})
db.dijaki.insert({"Ime":"Nejc", "Priimek":"Mihelič", "Stevilka":108})
db.dijaki.insert({"Ime":"Nejc", "Priimek":"Mihelič", "Stevilka":109})
db.dijaki.insert({"Ime":"Nejc", "Priimek":"Mihelič", "Stevilka":110})

b) Posodobite zapis z zaporedno številko 108. Zamenjajte mu ime.
db.dijaki.update({"Stevilka":108}, { $set: {"Ime":"Janez"} })

c) Posodobite zapis z zaporedno številko 106. Odstranite mu priimek.
db.dijaki.save({"_id":ObjectId("605454abf82e74929d49e1e4"), "Ime":"Nejc", "Stevilka":106})

d) Zbrišite zapis z zaporedno številko 107.
db.dijaki.remove({"Stevilka":107})

e) Preštejte zapise v vaši kolekciji.
db.dijaki.count()

f) Izvozite vašo kolekcijo kot json / jsonArray / csv datoteko.
- mongoexport /d 4Rb_Mihelic /c dijaki /jsonArray > dijaki.json
- mongoexport /d 4Rb_Mihelic /c dijaki > dijaki.json
- mongoexport /d 4Rb_Mihelic /c dijaki /type:csv /fields:_id,ime,priimek,stevilka > dijaki.csv



3. Ustvarite omejeno kolekcijo z imenom stranke, ki je omejena z 2MB oz. s petimi dokumenti.
db.createCollection("stranke", { capped:true, size:2*1024*1024, max:5})

a) Vanjo vstavite deset dokumentov. Kaj se zgodi?
V kolekcijo se shrani zadnjih pet dokumentov.

b) Izbrišite poljuben dokument. Kaj se zgodi?
Ne moremo izbrisati dokumenta iz omejene kolekcije (cannot remove from a capped collection: 4Rb_Mihelic.stranke).



4. Restavrirajte podatkovno zbirko datoteke.
mongorestore

a) Iz nje izpišite seznam datotek in eno datoteko shranite na disk.
mongofiles /d datoteke list
mongofiles /d datoteke get puščava.jpg

b) Poiščite datoteke, ki vsebujejo črko k.
mongofiles /d datoteke search k

c) Poiščite datoteke, ki se začnejo na črko k.
mongofiles /d datoteke list k

d) Izbrišite datoteko meduza.jpg.
mongofiles /d datoteke delete meduza.jpg

e) Vstavite datoteko NUB-3PN-preverjanje-2020.pdf v podatkovno zbirko dokumenti.
mongofiles /d dokumenti put NUB-3PN-preverjanje-2020.pdf